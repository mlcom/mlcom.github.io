<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml" />
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7391081469827045"
            crossorigin="anonymous">
    <title>{{page.title}} | {{site.name}}</title>

    {% seo %}

    <link rel="shortcut icon" type="image/x-icon" href="{{site.baseurl}}/{{site.favicon}}">

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

    <!-- Google Fonts-->
    <link href="https://fonts.googleapis.com/css?family=Lora:400,400i,700" rel="stylesheet">

    <!-- Bootstrap Modified -->
    <link rel="stylesheet" href="{{site.baseurl}}/assets/css/main.css">

    <!-- Theme Stylesheet -->
    <link rel="stylesheet" href="{{site.baseurl}}/assets/css/theme.css">

    <!-- Jquery on header to make sure everything works, the rest  of the scripts in footer for fast loading -->
    <script
    src="https://code.jquery.com/jquery-3.3.1.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
    crossorigin="anonymous"></script>

    {% include tracking-header.html %}


</head>

<body class="{% if page.url == "/" %} homefirstpage {% endif %}">

    <!-- Navbar -->
    <nav id="MagicMenu" class="topnav navbar navbar-expand-lg navbar-light bg-white fixed-top">
    <div class="container">
        <a class="navbar-brand" href="{{ site.baseurl }}/index.html"><strong>{{site.name}}</strong></a>
        <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarColor02" aria-controls="navbarColor02" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
        </button>
        <div class="navbar-collapse collapse" id="navbarColor02" style="">
            <ul class="navbar-nav mr-auto d-flex align-items-center">
               {% include menu-header.html %}
            </ul>
            <ul class="navbar-nav ml-auto d-flex align-items-center">
                {% include search-lunr.html %}
            </ul>
        </div>
    </div>
    </nav>

    <!-- Search Results -->
    <div id="lunrsearchresults">
        <ul class="mb-0"></ul>
    </div>

   <main role="main" class="site-content">

        <!-- ===== START FINAL LIVE CURRENCY CALCULATOR ===== -->
        <div class="container pt-4 pb-4">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Live Currency Converter</h5>
                    <!-- The fieldset is disabled until the rates are loaded -->
                    <fieldset id="currency-calculator-fieldset" disabled>
                        <div id="currency-calculator">
                            <div class="form-row">
                                <!-- Amount Input -->
                                <div class="form-group col-md-12">
                                    <label for="amount">Amount</label>
                                    <input type="number" id="amount" class="form-control" value="100" placeholder="Enter amount">
                                </div>
                                <!-- From Currency -->
                                <div class="form-group col-md-6">
                                    <label for="from_currency">From</label>
                                    <select id="from_currency" class="form-control">
                                        <option value="USD">ðŸ‡ºðŸ‡¸ USD - US Dollar</option>
                                        <option value="PKR" selected>ðŸ‡µðŸ‡° PKR - Pakistani Rupee</option>
                                        <option value="EUR">ðŸ‡ªðŸ‡º EUR - Euro</option>
                                        <option value="GBP">ðŸ‡¬ðŸ‡§ GBP - British Pound</option>
                                        <option value="AED">ðŸ‡¦ðŸ‡ª AED - UAE Dirham</option>
                                        <option value="INR">ðŸ‡®ðŸ‡³ INR - Indian Rupee</option>
                                        <option value="JPY">ðŸ‡¯ðŸ‡µ JPY - Japanese Yen</option>
                                        <option value="CAD">ðŸ‡¨ðŸ‡¦ CAD - Canadian Dollar</option>
                                    </select>
                                </div>
                                <!-- To Currency -->
                                <div class="form-group col-md-6">
                                    <label for="to_currency">To</label>
                                    <select id="to_currency" class="form-control">
                                        <option value="USD" selected>ðŸ‡ºðŸ‡¸ USD - US Dollar</option>
                                        <option value="PKR">ðŸ‡µðŸ‡° PKR - Pakistani Rupee</option>
                                        <option value="EUR">ðŸ‡ªðŸ‡º EUR - Euro</option>
                                        <option value="GBP">ðŸ‡¬ðŸ‡§ GBP - British Pound</option>
                                        <option value="AED">ðŸ‡¦ðŸ‡ª AED - UAE Dirham</option>
                                        <option value="INR">ðŸ‡®ðŸ‡³ INR - Indian Rupee</option>
                                        <option value="JPY">ðŸ‡¯ðŸ‡µ JPY - Japanese Yen</option>
                                        <option value="CAD">ðŸ‡¨ðŸ‡¦ CAD - Canadian Dollar</option>
                                    </select>
                                </div>
                            </div>
                            <!-- Result and Status Messages -->
                            <div id="result_container" class="mt-3">
                                <h6 id="result_text" class="text-success font-weight-bold"></h6>
                                <p id="status_text" class="text-muted"></p>
                            </div>
                        </div>
                    </fieldset>
                     <small id="disclaimer_text" class="text-muted">Rates sourced from frankfurter.dev, updated daily via the European Central Bank.</small>
                </div>
            </div>
        </div>

        <script>
        document.addEventListener('DOMContentLoaded', function() {
            
            const amountInput = document.getElementById('amount');
            const fromSelect = document.getElementById('from_currency');
            const toSelect = document.getElementById('to_currency');
            const resultText = document.getElementById('result_text');
            const statusText = document.getElementById('status_text');
            const fieldset = document.getElementById('currency-calculator-fieldset');
            
            let liveRates = {};

            // Function to fetch rates using the correct API endpoint
            async function fetchRates(baseCurrency) {
                statusText.textContent = 'Loading latest rates...';
                // Using the correct URL: https://api.frankfurter.dev
                const apiUrl = `https://api.frankfurter.dev/latest?from=${baseCurrency}`;

                try {
                    const response = await fetch(apiUrl);
                    if (!response.ok) throw new Error('Network response was not ok.');
                    
                    const data = await response.json();
                    
                    // Store the fetched rates
                    liveRates = data.rates;
                    // Add the base currency to the rates object since the API doesn't include it in the response
                    liveRates[data.base] = 1;
                    
                    fieldset.disabled = false; // Enable the form
                    statusText.textContent = ''; // Clear loading message
                    convertCurrency(); // Perform initial conversion after fetching
                } catch (error) {
                    console.error('Fetch error:', error);
                    statusText.innerHTML = '<span class="text-danger">Could not fetch rates. Please try again later.</span>';
                }
            }

            // The main conversion function
            function convertCurrency() {
                // Ensure rates are available before calculating
                if (Object.keys(liveRates).length === 0) return;

                const amount = parseFloat(amountInput.value);
                const targetCurrency = toSelect.value;

                // If amount is not a valid number, clear the result
                if (isNaN(amount) || amount <= 0) {
                    resultText.textContent = '';
                    return;
                }
                
                // Perform the calculation using the stored rates
                const convertedAmount = amount * liveRates[targetCurrency];

                // Nicely format the result and display it on the page
                const fromSymbol = fromSelect.options[fromSelect.selectedIndex].text.split(' ')[1];
                const toSymbol = toSelect.options[toSelect.selectedIndex].text.split(' ')[1];

                resultText.innerHTML = `${amount.toLocaleString()} ${fromSymbol} = <span class="text-primary">${convertedAmount.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span> ${toSymbol}`;
            }

            // EVENT LISTENERS

            // When the 'From' currency changes, fetch the new set of rates
            fromSelect.addEventListener('change', () => {
                fetchRates(fromSelect.value);
            });

            // When amount or 'To' currency changes, just re-calculate with existing rates
            amountInput.addEventListener('input', convertCurrency);
            toSelect.addEventListener('change', convertCurrency);

            // Initial Action: Fetch rates as soon as the page loads
            fetchRates(fromSelect.value);
        });
        </script>
        <!-- ===== END FINAL LIVE CURRENCY CALCULATOR ===== -->


        {{ content }}
    </main>


    <!-- Scripts: popper, bootstrap, theme, lunr -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

    <script src="{{site.baseurl}}/assets/js/theme.js"></script>


    <!-- Footer -->
    <footer class="bg-white border-top p-3 text-muted small">
        <div class="container">
        <div class="row align-items-center justify-content-between">
            <div>
                <span class="navbar-brand mr-2 mb-0"><strong>ML Community</strong></span>
                <span>Copyright Â© <script>document.write(new Date().getFullYear())</script>.</span>
            </div>
        </div>
        </div>
    </footer>

    {% include tracking-footer.html %}

</body>

</html>
